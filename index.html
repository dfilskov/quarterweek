<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>QuarterWeek configuration</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</head
<body>
  <div class="container">
    <h2>QuarterWeek configuration</h2>
    <form>
      <div class="checkbox">
        <label>
          <input type="checkbox" id="showInverted"> Dark background
        </label>
      </div>
      <div class="checkbox">
        <label>
          <input type="checkbox" id="allowChangeInvertOnStartup"> Allow shake on startup to switch background
        </label>
      </div>
      <!--<div class="form-group">-->
        <!--<label for="someOtherControl">Some other control</label>-->
        <!--<input class="form-control" id="someOtherControl" placeholder="Write something here">-->
      <!--</div>-->
      <hr />
      <button id="submitButton" class="btn btn-default">Save</button>
      <button id="closeButton" class="btn btn-default">Close</button>
    </form>
  </div>
  <script>
  $(function() {
    var submitButton = document.getElementById('submitButton');
    var closeButton = document.getElementById('closeButton');
    var showInvertedInput = document.getElementById('showInverted');
    var allowChangeInvertOnStartupInput = document.getElementById('allowChangeInvertOnStartup');
    //var someOtherControl = document.getElementById('someOtherControl');
    var returnTo = 'pebblejs://close';

    $('#closeButton').click(function(event) {
      event.preventDefault();
      console.log('closing ' + returnTo);
      document.location = returnTo;
    });

    $('#submitButton').click(function(event) {
      event.preventDefault();
      // someOtherControl: someOtherControl.value
      var settings = { showInverted : showInvertedInput.checked, allowChangeInvertOnStartup : allowChangeInvertOnStartupInput.checked  };
      var json = JSON.stringify(settings);
      console.log('submitting: ' + json);
      document.location = returnTo + '#' + encodeURIComponent(json);
    });
    
    // Read default values
    var hash = window.location.hash.substring(1);
    var config = JSON.parse(decodeURIComponent(hash));
    console.log(JSON.stringify(config));
    allowChangeInvertOnStartupInput.checked = config.allowChangeInvertOnStartup;
    showInvertedInput.checked = config.showInverted;
  });
  </script>
</body>
  
</html>
